<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>org.apache.drill.exec.physical.impl.scan (Drill : 1.21.2-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.drill.exec.physical.impl.scan">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html#package">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li><a href="#related-package-summary">Related Packages</a>&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package org.apache.drill.exec.physical.impl.scan" class="title">Package org.apache.drill.exec.physical.impl.scan</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">org.apache.drill.exec.physical.impl.scan</span></div>
<section class="package-description" id="package-description">
<div class="block">Defines the scan operation implementation. The scan operator is a generic mechanism
 that fits into the Drill Volcano-based iterator protocol to return record batches
 from one or more readers.
 <p>
 Two versions of the scan operator exist:<ul>
 <li><code>ScanBatch</code>: the original version that uses readers based on the
 <code>RecordReader</code> interface. <tt>ScanBatch</tt> cannot, however, handle
 limited-length vectors.</li>
 <li><a href="ScanOperatorExec.html" title="class in org.apache.drill.exec.physical.impl.scan"><code>ScanOperatorExec</code></a>: the revised version that uses a more modular
 design and that offers a mutator that is a bit easier to use, and can limit
 vector sizes.</li></ul>
 New code should use the new version, existing code will continue to use the
 <tt>ScanBatch</tt> version until all readers are converted to the new format.
 <p>
 Further, the new version is designed to allow intensive unit test without
 the need for the Drill server. New readers should exploit this feature to
 include intensive tests to keep Drill quality high.
 <p>
 See <a href="ScanOperatorExec.html" title="class in org.apache.drill.exec.physical.impl.scan"><code>ScanOperatorExec</code></a> for details of the scan operator protocol
 and components.

 <h4>Traditional Class Structure<h4>
 The original design was simple: but required each reader to handle many
 detailed tasks.
 <pre><code>
  +------------+          +-----------+
  | Scan Batch |    +---> | ScanBatch |
  |  Creator   |    |     +-----------+
  +------------+    |           |
         |          |           |
         v          |           |
  +------------+    |           v
  |   Format   | ---+   +---------------+
  |   Plugin   | -----> | Record Reader |
  +------------+        +---------------+

 </code></pre>

 The scan batch creator is unique to each storage plugin and is created
 based on the physical operator configuration ("pop config"). The
 scan batch creator delegates to the format plugin to create both the
 scan batch (the scan operator) and the set of readers which the scan
 batch will manage.
 <p>
 The scan batch
 provides a <code>Mutator</code> that creates the vectors used by the
 record readers. Schema continuity comes from reusing the Mutator from one
 file/block to the next.
 <p>
 One characteristic of this system is that all the record readers are
 created up front. If we must read 1000 blocks, we'll create 1000 record
 readers. Developers must be very careful to only allocate resources when
 the reader is opened, and release resources when the reader is closed.
 Else, resource bloat becomes a large problem.

 <h4>Revised Class Structure</h4>

 The new design is more complex because it divides tasks up into separate
 classes. The class structure is larger, but each class is smaller, more
 focused and does just one task.
 <pre><code>
  +------------+          +---------------+
  | Scan Batch | -------> | Format Plugin |
  |  Creator   |          +---------------+
  +------------+          /        |       \
                         /         |        \
    +---------------------+        |         \ +---------------+
    | OperatorRecordBatch |        |     +---->| ScanFramework |
    +---------------------+        |     |     +---------------+
                                   v     |            |
                         +------------------+         |
                         | ScanOperatorExec |         |
                         +------------------+         v
                                   |            +--------------+
                                   +----------> | Batch Reader |
                                                +--------------+
 </code></pre>

 Here, the scan batch creator again delegates to the format plugin. The
 format plugin creates three objects:
 <ul>
 <li>The <code>OperatorRecordBatch</code>, which encapsulates the Volcano
 iterator protocol. It also holds onto the output batch. This allows the
 operator implementation to just focus on its specific job.</li>
 <li>The <code>ScanOperatorExec</code> is the operator implementation for
 the new result-set-loader based scan.</li>
 <li>The scan framework is specific to each kind of reader. It handles
 everything which is unique to that reader. Rather than inheriting from
 the scan itself, the framework follows the strategy pattern: it says how
 to do a scan for the target format.<li>
 </ul>

 The overall structure uses the "composition" pattern: what is combined
 into a small set of classes in the traditional model is broken out into
 focused classes in the revised model.
 <p>
 A key part of the scan strategy is the batch reader. ("Batch" because
 it reads an entire batch at a time, using the result set loader.) The
 framework creates batch readers one by one as needed. Resource bloat
 is less of an issue because only one batch reader instance exists at
 any time for each scan operator instance.
 <p>
 Each of the above is further broken down into additional classes to
 handle projection and so on.</div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="related-package-summary">
<div class="caption"><span>Related Packages</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Package</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><a href="../package-summary.html">org.apache.drill.exec.physical.impl</a></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><a href="columns/package-summary.html">org.apache.drill.exec.physical.impl.scan.columns</a></div>
<div class="col-last odd-row-color">
<div class="block">Handles the special "columns" column used by the text reader,
 and available to similar readers.</div>
</div>
<div class="col-first even-row-color"><a href="convert/package-summary.html">org.apache.drill.exec.physical.impl.scan.convert</a></div>
<div class="col-last even-row-color">
<div class="block">Standard type conversion tools for the case in which the input
 types are the standard Java types already supported by the
 <code>ValuesWriter</code> interface.</div>
</div>
<div class="col-first odd-row-color"><a href="file/package-summary.html">org.apache.drill.exec.physical.impl.scan.file</a></div>
<div class="col-last odd-row-color">
<div class="block">Handles optional file metadata columns: implicit columns and
 partition columns.</div>
</div>
<div class="col-first even-row-color"><a href="framework/package-summary.html">org.apache.drill.exec.physical.impl.scan.framework</a></div>
<div class="col-last even-row-color">
<div class="block">Defines the projection, vector continuity and other operations for
 a set of one or more readers.</div>
</div>
<div class="col-first odd-row-color"><a href="project/package-summary.html">org.apache.drill.exec.physical.impl.scan.project</a></div>
<div class="col-last odd-row-color">
<div class="block">Provides run-time semantic analysis of the projection list for the
 scan operator.</div>
</div>
<div class="col-first even-row-color"><a href="v3/package-summary.html">org.apache.drill.exec.physical.impl.scan.v3</a></div>
<div class="col-last even-row-color">
<div class="block">Provides the "version 3" scan framework (which can also be thought of
 as EVF version 2).</div>
</div>
</div>
</div>
</li>
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab1" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab1', 2)" class="table-tab">Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel">
<div class="summary-table two-column-summary" aria-labelledby="class-summary-tab0">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="RowBatchReader.html" title="interface in org.apache.drill.exec.physical.impl.scan">RowBatchReader</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Extended version of a record reader used by the revised
 scan batch operator.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="ScanOperatorEvents.html" title="interface in org.apache.drill.exec.physical.impl.scan">ScanOperatorEvents</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Interface to the set of readers, and reader schema, that the scan operator
 manages.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ScanOperatorExec.html" title="class in org.apache.drill.exec.physical.impl.scan">ScanOperatorExec</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Implementation of the revised scan operator that uses a mutator aware of
 batch sizes.</div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2023 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
