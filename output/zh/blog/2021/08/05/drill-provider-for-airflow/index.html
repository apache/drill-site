<!DOCTYPE html>
<html>

<head>

<meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">


<title>Drill provider for Airflow - Apache Drill</title>

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/site.css" rel="stylesheet" type="text/css"/>

<link rel="shortcut icon" href="/zh/favicon.ico" type="image/x-icon"/>
<link rel="icon" href="/zh/favicon.ico" type="image/x-icon"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js" language="javascript" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js" language="javascript" type="text/javascript"></script>
<script language="javascript" type="text/javascript" src="/js/modernizr.custom.js"></script>
<script language="javascript" type="text/javascript" src="/js/script.js"></script>
<script language="javascript" type="text/javascript" src="/js/drill.js"></script>

</head>


<body onResize="resized();">
  <div class="page-wrap">
    <div class="bui"></div>

<div id="menu" class="mw">
<ul>
  <li class='toc-categories'>
  <a class="expand-toc-icon" href="javascript:void(0);"><i class="fa fa-bars"></i></a>
  </li>
  <li class="logo"><a href="/zh/"></a></li>
  <li class='expand-menu'>
  <a href="javascript:void(0);"><span class='menu-text'>Menu</span><span class='expand-icon'><i class="fa fa-bars"></i></span></a>
  </li>
  <li class="clear-float"></li>
  <li class="nav">
	<a>Language</a>
	<ul>
		
		<li>
			<a  href="/blog/2021/08/05/drill-provider-for-airflow/" >en</a>
		</li>
		
		<li>
			<a style="font-weight: bold;" href="/zh/blog/2021/08/05/drill-provider-for-airflow/" >zh</a>
		</li>
		
	</ul>
  </li>
  <li class="apache-link">
    <a href="/zh/apacheASF/">Apache</a>
  </li>
  <li class="poweredby">
    <a href="/zh/poweredBy">Powered By</a>
  </li>
  <li class="documentation-menu">
    <a href="/zh/docs/">Documentation</a>
    <ul>
	  
      
        <li><a href="/zh/docs/getting-started/">新手开始</a></li>
      
        <li><a href="/zh/docs/architecture/">Architecture</a></li>
      
        <li><a href="/zh/docs/tutorials/">教程</a></li>
      
        <li><a href="/zh/docs/drill-on-yarn/">Drill-on-YARN</a></li>
      
        <li><a href="/zh/docs/install-drill/">Install Drill</a></li>
      
        <li><a href="/zh/docs/configure-drill/">Configure Drill</a></li>
      
        <li><a href="/zh/docs/connect-a-data-source/">Connect a Data Source</a></li>
      
        <li><a href="/zh/docs/odbc-jdbc-interfaces/">ODBC/JDBC Interfaces</a></li>
      
        <li><a href="/zh/docs/query-data/">Query Data</a></li>
      
        <li><a href="/zh/docs/performance-tuning/">Performance Tuning</a></li>
      
        <li><a href="/zh/docs/log-and-debug/">Log and Debug</a></li>
      
        <li><a href="/zh/docs/sql-reference/">SQL Reference</a></li>
      
        <li><a href="/zh/docs/data-sources-and-file-formats/">Data Sources and File Formats</a></li>
      
        <li><a href="/zh/docs/develop-custom-functions/">Develop Custom Functions</a></li>
      
        <li><a href="/zh/docs/troubleshooting/">Troubleshooting</a></li>
      
        <li><a href="/zh/docs/developer-information/">Developer Information</a></li>
      
        <li><a href="/zh/docs/release-notes/">Release Notes</a></li>
      
        <li><a href="/zh/docs/sample-datasets/">Sample Datasets</a></li>
      
        <li><a href="/zh/docs/project-bylaws/">Project Bylaws</a></li>
      
        <li><a href="/zh/docs/ecosystem/">Ecosystem</a></li>
      
    </ul>
  </li>
  <li class='nav'>
    <a href="/zh/community-resources/">Community</a>
    <ul>
      <li><a href="/zh/team/">Team</a></li>
      <li><a href="/zh/mailinglists/">Mailing Lists</a></li>
      <li><a href="/zh/community-resources/">Community Resources</a></li>
    </ul>
  </li>
  <li class='nav'><a href="/zh/faq/">FAQ</a></li>
  <li class='nav'><a href="/zh/blog/">Blog</a></li>
  <li class="social-menu-item"><a href="https://twitter.com/apachedrill" title="apachedrill on twitter" target="_blank"><img src="/images/twitter_32_26_white.png" alt="twitter logo" align="center"></a> </li>
  <li class="social-menu-item"><a href="https://join.slack.com/t/apache-drill/shared_invite/enQtNTQ4MjM1MDA3MzQ2LTJlYmUxMTRkMmUwYmQ2NTllYmFmMjU4MDk0NjYwZjBmYjg0MDZmOTE2ZDg0ZjBlYmI3Yjc4Y2I2NTQyNGVlZTc" title="Apache Drill Slack channels"
      target="_blank"><img src="/images/slack-logo.svg" alt="Slack logo" align="center"></a> </li>
  <li class='search-bar'>
    <form id="drill-search-form">
      <input type="text" placeholder="Search Apache Drill" id="drill-search-term" />
      <button type="submit">
        <i class="fa fa-search"></i>
      </button>
    </form>
  </li>
  <li class="d">
    <a href="/zh/download/">
      <i class="fa fa-cloud-download"></i> Download
    </a>
  </li>
</ul>
</div>

    <link href="/css/content.css" rel="stylesheet" type="text/css">

<div class="post int_text">
  <header class="post-header">
    <div class="int_title">
      <h1 class="post-title">Drill provider for Airflow</h1>
    </div>
    <p class="post-meta">
    
      
      
      <strong>Author:</strong> James Turton (Committer, Apache Software Foundation)<br />
    
<strong>Date:</strong> Aug 5, 2021
</p>
  </header>
  <div class="addthis_sharing_toolbox"></div>

  <article class="post-content">
    <p>You’re building a new report, visualisation or ML model.  Most of the data involved comes from sources well known to you but a new source has become available, allowing your team to measure and model new variables.  Eager to get to a prototype and an early sense of what the new analytics look like, you head straight for the first order of business and start to construct a first version of the dataset upon which your final output will be based.</p>

<p>The data sources you need to combine are immediately accessible but heteregenous: transactional data in PostgreSQL must be combined with data from another team that uses Splunk, lookup data maintained by operational team in an Excel spreadsheet, thousands of XML exports received from a partner and some Parquet files already in your big data environment just for good measure.</p>

<p>Using Drill iteratively you query and join in each data source one at a time, applying grouping, filtering and other intensive transformations as you go, finally producing a dataset with the fields and grain you need.  You store it by adding CREATE TABLE AS in front of your final SELECT then write a few counting and summing queries against the original data sources and your transformed dataset to check that your code produces the expected outputs.</p>

<p>Apart from possibly configuring some new storage plugins in the Drill web UI, you have so far not left your SQL editor.  The onerous data exploration and plumbing parts of your project have flashed by in a blaze of SQL, and you move your dataset into the next tool for visualisation or modelling.  The results are good and you know that your users will immediately ask for the outputs to incorporate new data on a regular schedule.</p>

<p>While Drill can assemble your dataset on the fly, as it did while you prototyped,  doing that for the full set takes over 40 minutes, places more load than you’d like in office hours on to your data sources and limits you to the history that the sources keep, in some cases only a few weeks.</p>

<p>It’s time for ETL, you concede.  In the past that meant you had to choose between keeping your working Drill SQL and scheduling it using 70s Unix tools like Cron and Bash, seeing what you could jury-rig using some ETL software and interfaces to Drill like like ODBC and JDBC, or recreating your Drill SQL entirely in (perhaps multiple) other tools and languages, perhaps Spark and Python.  But this time you can do things differently…</p>

<p><a href="https://airflow.apache.org">Apache Airflow</a> is a workflow engine built in the Python programming ecosystem that has grown into a leading choice for orchestrating big data pipelines, amongst its other applications.  Perhaps the first point to understand about Airflow in the context of ETL is that it is designed only for workflow <em>control</em>, and not for data flow.  This makes it different from some of the ETL tools you might have encountered like Microsoft’s SSIS or Pentaho’s PDI which handle both control and data flow: these ETL tools will <em>themselves</em> connect to a data source and stream data records from it.</p>

<p>In contrast Airflow is, unless you’re doing it wrong, used only to instruct other software like Spark, Beam, PostgreSQL, Bash, Celery, Scikit-learn scripts, Slack, (… the list of providers is long and varied) to kick off actions at scheduled times.  While Airflow does load its schedules from the crontab format, a comparison to cron stops there.  Airflow can resolve and execute complex job DAGs with options for clustering, parallelism, retries, backfilling and performance monitoring.</p>

<p>The exciting news for Drill users is that <a href="https://pypi.org/project/apache-airflow-providers-apache-drill/">a new provider package adding support for Drill</a> was added to Airflow this month.  This provider is based on the <a href="https://pypi.org/project/sqlalchemy-drill/">sqlalchemy-drill package</a> which provides Drill connectivity for Python programs.  This means that you can add tasks which execute queries on Drill to your Airflow DAGs without any hacky intermediate shell scripts, or build new Airflow operators that use the Drill hook.</p>

<p>A new tutorial that walks through the development of a simple Airflow DAG that uses the Drill provider <a href="/zh/docs/orchestrating-queries-with-airflow/">is available here</a>.</p>

  </article>
 <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'drill'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
</div>
<script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-548b2caa33765e8d" async="async"></script>

  </div>
  <p class="push"></p>
<div id="footer" class="mw">
<div class="wrapper">
Copyright © 2012-2025 The Apache Software Foundation, licensed under the Apache License, Version 2.0.<br>
Apache and the Apache feather logo are trademarks of The Apache Software Foundation. Other names appearing on the site may be trademarks of their respective owners.<br/><br/>
</div>
</div>

  <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-53379651-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-548b2caa33765e8d" async="async"></script>

</body>
</html>
