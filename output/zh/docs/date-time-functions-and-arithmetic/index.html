<!DOCTYPE html>
<html>

<head>

<meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">


<title>Date/Time Functions and Arithmetic - Apache Drill</title>

<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
<link href="/css/site.css" rel="stylesheet" type="text/css"/>

<link rel="shortcut icon" href="/zh/favicon.ico" type="image/x-icon"/>
<link rel="icon" href="/zh/favicon.ico" type="image/x-icon"/>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js" language="javascript" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js" language="javascript" type="text/javascript"></script>
<script language="javascript" type="text/javascript" src="/js/modernizr.custom.js"></script>
<script language="javascript" type="text/javascript" src="/js/script.js"></script>
<script language="javascript" type="text/javascript" src="/js/drill.js"></script>

</head>


<body onResize="resized();">
  <div class="page-wrap">
    <div class="bui"></div>

<div id="menu" class="mw">
<ul>
  <li class='toc-categories'>
  <a class="expand-toc-icon" href="javascript:void(0);"><i class="fa fa-bars"></i></a>
  </li>
  <li class="logo"><a href="/zh/"></a></li>
  <li class='expand-menu'>
  <a href="javascript:void(0);"><span class='menu-text'>Menu</span><span class='expand-icon'><i class="fa fa-bars"></i></span></a>
  </li>
  <li class="clear-float"></li>
  <li class="nav">
	<a>Language</a>
	<ul>
		
		<li>
			<a  href="/docs/date-time-functions-and-arithmetic/" >en</a>
		</li>
		
		<li>
			<a style="font-weight: bold;" href="/zh/docs/date-time-functions-and-arithmetic/" >zh</a>
		</li>
		
	</ul>
  </li>
  <li class="apache-link">
    <a href="/zh/apacheASF/">Apache</a>
  </li>
  <li class="poweredby">
    <a href="/zh/poweredBy">Powered By</a>
  </li>
  <li class="documentation-menu">
    <a href="/zh/docs/">Documentation</a>
    <ul>
	  
      
        <li><a href="/zh/docs/getting-started/">新手开始</a></li>
      
        <li><a href="/zh/docs/architecture/">Architecture</a></li>
      
        <li><a href="/zh/docs/tutorials/">教程</a></li>
      
        <li><a href="/zh/docs/drill-on-yarn/">Drill-on-YARN</a></li>
      
        <li><a href="/zh/docs/install-drill/">Install Drill</a></li>
      
        <li><a href="/zh/docs/configure-drill/">Configure Drill</a></li>
      
        <li><a href="/zh/docs/connect-a-data-source/">Connect a Data Source</a></li>
      
        <li><a href="/zh/docs/odbc-jdbc-interfaces/">ODBC/JDBC Interfaces</a></li>
      
        <li><a href="/zh/docs/query-data/">Query Data</a></li>
      
        <li><a href="/zh/docs/performance-tuning/">Performance Tuning</a></li>
      
        <li><a href="/zh/docs/log-and-debug/">Log and Debug</a></li>
      
        <li><a href="/zh/docs/sql-reference/">SQL Reference</a></li>
      
        <li><a href="/zh/docs/data-sources-and-file-formats/">Data Sources and File Formats</a></li>
      
        <li><a href="/zh/docs/develop-custom-functions/">Develop Custom Functions</a></li>
      
        <li><a href="/zh/docs/troubleshooting/">Troubleshooting</a></li>
      
        <li><a href="/zh/docs/developer-information/">Developer Information</a></li>
      
        <li><a href="/zh/docs/release-notes/">Release Notes</a></li>
      
        <li><a href="/zh/docs/sample-datasets/">Sample Datasets</a></li>
      
        <li><a href="/zh/docs/project-bylaws/">Project Bylaws</a></li>
      
        <li><a href="/zh/docs/ecosystem/">Ecosystem</a></li>
      
    </ul>
  </li>
  <li class='nav'>
    <a href="/zh/community-resources/">Community</a>
    <ul>
      <li><a href="/zh/team/">Team</a></li>
      <li><a href="/zh/mailinglists/">Mailing Lists</a></li>
      <li><a href="/zh/community-resources/">Community Resources</a></li>
    </ul>
  </li>
  <li class='nav'><a href="/zh/faq/">FAQ</a></li>
  <li class='nav'><a href="/zh/blog/">Blog</a></li>
  <li class="social-menu-item"><a href="https://twitter.com/apachedrill" title="apachedrill on twitter" target="_blank"><img src="/images/twitter_32_26_white.png" alt="twitter logo" align="center"></a> </li>
  <li class="social-menu-item"><a href="https://join.slack.com/t/apache-drill/shared_invite/enQtNTQ4MjM1MDA3MzQ2LTJlYmUxMTRkMmUwYmQ2NTllYmFmMjU4MDk0NjYwZjBmYjg0MDZmOTE2ZDg0ZjBlYmI3Yjc4Y2I2NTQyNGVlZTc" title="Apache Drill Slack channels"
      target="_blank"><img src="/images/slack-logo.svg" alt="Slack logo" align="center"></a> </li>
  <li class='search-bar'>
    <form id="drill-search-form">
      <input type="text" placeholder="Search Apache Drill" id="drill-search-term" />
      <button type="submit">
        <i class="fa fa-search"></i>
      </button>
    </form>
  </li>
  <li class="d">
    <a href="/zh/download/">
      <i class="fa fa-cloud-download"></i> Download
    </a>
  </li>
</ul>
</div>

    <link href="/css/content.css" rel="stylesheet" type="text/css">


      




<aside class="sidebar">
  <div class="docsidebar">
    <div class="docsidebarwrapper">
      <ul style="display: block;">
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">新手开始</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/drill-introduction/">什么是 Drill</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/why-drill/">为什么选择 Drill</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Architecture</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/architecture-introduction/">Architecture Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/drill-query-execution/">Drill Query Execution</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/core-modules/">Core Modules</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/performance/">Performance</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">教程</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/tutorials-introduction/">教程介绍</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/drill-in-10-minutes/">10分钟了解 Drill</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/analyzing-the-yelp-academic-dataset/">分析 Yelp 学术数据集</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">搭配 MapR Sandbox 学习 Drill</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/about-the-mapr-sandbox/">关于 MapR 沙盒</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-the-apache-drill-sandbox/">安装 Apache Drill SandBox</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/getting-to-know-the-drill-sandbox/">了解 Drill Sandbox</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/lesson-1-learn-about-the-data-set/">第一课: 学习数据集</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/lesson-2-run-queries-with-ansi-sql/">第二课: 使用 ANSI SQL 查询</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/lesson-3-run-queries-on-complex-data-types/">第三课: 查询复杂数据类型</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/summary/">总结</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/analyzing-highly-dynamic-datasets/">分析高动态数据集</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/analyzing-social-media/">分析社交媒体</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/analyzing-data-using-window-functions/">通过窗口函数分析数据集</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/orchestrating-queries-with-airflow/">使用 Airflow 编排查询</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Drill-on-YARN</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/drill-on-yarn-introduction/">Drill-on-YARN Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/creating-a-basic-drill-cluster/">Creating a Basic Drill Cluster</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/launch-drill-under-yarn/">Launch Drill Under YARN</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/configuration-reference/">Configuration Reference</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/drill-on-yarn-command-line-tool/">Drill-on-YARN Command-Line Tool</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/using-the-drill-on-yarn-web-ui/">Using the Drill-on-YARN Web UI</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/multiple-drill-clusters/">Multiple Drill Clusters</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/enabling-web-ui-security/">Enabling Web UI Security</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/appendix-a-release-note-issues/">Appendix A: Release Note Issues</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/appendix-b-drill-env-sh-settings/">Appendix B: drill-env.sh Settings</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/appendix-c-troubleshooting/">Appendix C: Troubleshooting</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/appendix-d-recreate-the-drill-archive/">Appendix D: Recreate the Drill Archive</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Install Drill</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/install-drill-introduction/">Install Drill Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/migrating-parquet-data/">Migrating Parquet Data</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Installing Drill in Embedded Mode</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/embedded-mode-prerequisites/">Embedded Mode Prerequisites</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/running-drill-on-docker/">Running Drill on Docker</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-drill-on-linux-and-mac-os-x/">Installing Drill on Linux and Mac OS X</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/starting-drill-on-linux-and-mac-os-x/">Starting Drill on Linux and Mac OS X</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-drill-on-windows/">Installing Drill on Windows</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/starting-drill-on-windows/">Starting Drill on Windows</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Installing Drill in Distributed Mode</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/distributed-mode-prerequisites/">Distributed Mode Prerequisites</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-drill-on-the-cluster/">Installing Drill on the Cluster</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/starting-drill-in-distributed-mode/">Starting Drill in Distributed Mode</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/starting-the-web-ui/">Starting the Web UI</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/stopping-drill/">Stopping Drill</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/identifying-multiple-drill-versions-in-a-cluster/">Identifying Multiple Drill Versions in a Cluster</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Extended</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-drill-in-distributed-mode-with-gcp-dataproc/">Installing Drill in Distributed Mode with GCP Dataproc</a></li>
              
            </ul>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Configure Drill</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/configure-drill-introduction/">Configure Drill Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/configuring-drill-memory/">Configuring Drill Memory</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Securing Drill</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/securing-drill-introduction/">Securing Drill Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/secure-communication-paths/">Secure Communication Paths</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/roles-and-privileges/">Roles and Privileges</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-user-impersonation/">Configuring User Impersonation</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-inbound-impersonation/">Configuring Inbound Impersonation</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-user-impersonation-with-hive-authorization/">Configuring User Impersonation with Hive Authorization</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-user-security/">Configuring User Security</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-plain-security/">Configuring Plain Security</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-ssl-tls-for-encryption/">Configuring SSL/TLS for Encryption</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-libpam4j-as-the-pam-authenticator/">Using libpam4j as the PAM Authenticator</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-jpam-as-the-pam-authenticator/">Using jpam as the PAM Authenticator</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-htpasswd-file-authentication/">Configuring htpasswd file authentication</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-hashicorp-vault-authentication/">Configuring HashiCorp Vault authentication</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-kerberos-security/">Configuring Kerberos Security</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-drill-to-use-spnego-for-http-authentication/">Configuring Drill to use SPNEGO for HTTP Authentication</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-web-ui-and-rest-api-security/">Configuring Web UI and REST API Security</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-custom-acls-to-secure-znodes/">Configuring Custom ACLs to Secure znodes</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Configuring a Multitenant Cluster</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-a-multitenant-cluster-introduction/">Configuring a Multitenant Cluster Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-multitenant-resources/">Configuring Multitenant Resources</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-resources-for-a-shared-drillbit/">Configuring Resources for a Shared Drillbit</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Configuration Options</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuration-options-introduction/">Configuration Options Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/start-up-options/">Start-Up Options</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/planning-and-execution-options/">Planning and Execution Options</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/persistent-configuration-storage/">Persistent Configuration Storage</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/global-query-list/">Global Query List</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/ports-used-by-drill/">Ports Used by Drill</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/configuring-the-drill-shell/">Configuring the Drill Shell</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/configuring-cgroups-to-control-cpu-usage/">Configuring cgroups to Control CPU Usage</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Connect a Data Source</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/connect-a-data-source-introduction/">Connect a Data Source Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/storage-plugin-registration/">Storage Plugin Registration</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Storage Plugin Configuration</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/plugin-configuration-basics/">Plugin Configuration Basics</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-storage-plugins/">Configuring Storage Plugins</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/workspaces/">Workspaces</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drill-default-input-format/">Drill Default Input Format</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/file-system-storage-plugin/">File System Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/hbase-storage-plugin/">HBase Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/hive-storage-plugin/">Hive Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/rdbms-storage-plugin/">RDBMS Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/mongodb-storage-plugin/">MongoDB Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/mapr-db-format/">MapR-DB Format</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/s3-storage-plugin/">S3 Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/oci-os-storage-plugin/">OCI OS Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/opentsdb-storage-plugin/">OpenTSDB Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/kafka-storage-plugin/">Kafka Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/azure-blob-storage-plugin/">Azure Blob Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/druid-storage-plugin/">Druid Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/http-storage-plugin/">HTTP Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/elasticsearch-storage-plugin/">ElasticSearch Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/splunk-storage-plugin/">Splunk Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/cassandra-storage-plugin/">Cassandra Storage Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/dropbox-storage-plugin/">Dropbox Storage Plugin</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">ODBC/JDBC Interfaces</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/interfaces-introduction/">Interfaces Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/using-the-jdbc-driver/">Using the JDBC Driver</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/using-jdbc-with-squirrel-on-windows/">Using JDBC with SQuirreL on Windows</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Installing the ODBC Driver</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-the-driver-on-linux/">Installing the Driver on Linux</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-the-driver-on-mac-os-x/">Installing the Driver on Mac OS X</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/installing-the-driver-on-windows/">Installing the Driver on Windows</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Configuring ODBC</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/odbc-configuration-reference/">ODBC Configuration Reference</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/logging-and-tracing/">Logging and Tracing</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-odbc-on-linux/">Configuring ODBC on Linux</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-odbc-on-mac-os-x/">Configuring ODBC on Mac OS X</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-odbc-on-windows/">Configuring ODBC on Windows</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/testing-the-odbc-connection/">Testing the ODBC Connection</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Using Drill Explorer</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drill-explorer-introduction/">Drill Explorer Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/connecting-drill-explorer-to-data/">Connecting Drill Explorer to Data</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/browsing-data-and-defining-views/">Browsing Data and Defining Views</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Using Drill with BI Tools</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-drill-with-bi-tools-introduction/">Using Drill with BI Tools Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/tableau-examples/">Tableau Examples</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-microstrategy-analytics-with-apache-drill/">Using MicroStrategy Analytics with Apache Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-tibco-spotfire-desktop-with-drill/">Using Tibco Spotfire Desktop with Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-tibco-spotfire-server-with-drill/">Configuring Tibco Spotfire Server with Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-qlik-sense-with-drill/">Using Qlik Sense with Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-apache-drill-with-tableau-10-2/">Using Apache Drill with Tableau 10.2</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-apache-drill-with-tableau-9-desktop/">Using Apache Drill with Tableau 9 Desktop</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-apache-drill-with-tableau-9-server/">Using Apache Drill with Tableau 9 Server</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-information-builders-webfocus-with-apache-drill/">Using Information Builders’ WebFOCUS with Apache Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-jreport-with-drill/">Configuring JReport with Drill</a></li>
              
            </ul>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Query Data</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/query-data-introduction/">Query Data Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Querying a File System</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-a-file-system-introduction/">Querying a File System Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-avro-files/">Querying Avro Files</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-json-files/">Querying JSON Files</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-parquet-files/">Querying Parquet Files</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-plain-text-files/">Querying Plain Text Files</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-directories/">Querying Directories</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-sequence-files/">Querying Sequence Files</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/querying-hbase/">Querying HBase</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Querying Complex Data</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-complex-data-introduction/">Querying Complex Data Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/sample-data-donuts/">Sample Data: Donuts</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/selecting-flat-data/">Selecting Flat Data</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-sql-functions-clauses-and-joins/">Using SQL Functions, Clauses, and Joins</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/selecting-nested-data-for-a-column/">Selecting Nested Data for a Column</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/selecting-multiple-columns-within-nested-data/">Selecting Multiple Columns Within Nested Data</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/querying-hive/">Querying Hive</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/querying-the-information-schema/">Querying the INFORMATION SCHEMA</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Querying Indexes</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/querying-indexes-introduction/">Querying Indexes Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/queries-that-qualify-for-index-based-query-plans/">Queries that Qualify for Index-Based Query Plans</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/types-of-indexes/">Types of Indexes</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/index-selection/">Index Selection</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/designing-indexes-for-your-queries/">Designing Indexes for Your Queries</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/configuring-index-planning/">Configuring Index Planning</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/verifying-index-use/">Verifying Index Use</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/querying-system-tables/">Querying System Tables</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/monitoring-and-canceling-queries-in-the-drill-web-ui/">Monitoring and Canceling Queries in the Drill Web UI</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Performance Tuning</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Drill Metastore</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/using-drill-metastore/">Using Drill Metastore</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drill-iceberg-metastore/">Drill Iceberg Metastore</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/rdbms-metastore/">RDBMS Metastore</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/mongo-metastore/">Mongo Metastore</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/performance-tuning-introduction/">Performance Tuning Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Partition Pruning</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/partition-pruning-introduction/">Partition Pruning Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/how-to-partition-data/">How to Partition Data</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/asynchronous-parquet-reader/">Asynchronous Parquet Reader</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/optimizing-parquet-metadata-reading/">Optimizing Parquet Metadata Reading</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/parquet-filter-pushdown/">Parquet Filter Pushdown</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/hive-metadata-caching/">Hive Metadata Caching</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/choosing-a-storage-format/">Choosing a Storage Format</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Query Plans and Tuning</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/query-plans-and-tuning-introduction/">Query Plans and Tuning Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/join-planning-guidelines/">Join Planning Guidelines</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/guidelines-for-optimizing-aggregation/">Guidelines for Optimizing Aggregation</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/modifying-query-planning-options/">Modifying Query Planning Options</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/sort-based-and-hash-based-memory-constrained-operators/">Sort-Based and Hash-Based Memory-Constrained Operators</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/enabling-query-queuing/">Enabling Query Queuing</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/throttling/">Throttling</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/controlling-parallelization-to-balance-performance-with-multi-tenancy/">Controlling Parallelization to Balance Performance with Multi-Tenancy</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Identifying Performance Issues</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/query-plans/">Query Plans</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/query-profiles/">Query Profiles</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Performance Tuning Reference</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/query-profile-column-descriptions/">Query Profile Column Descriptions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/physical-operators/">Physical Operators</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/monitoring-metrics/">Monitoring Metrics</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Log and Debug</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/log-and-debug-introduction/">Log and Debug Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/error-messages/">Error Messages</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/modify-logback-xml/">Modify logback.xml</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/review-the-java-stack-trace/">Review the Java Stack Trace</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/query-audit-logging/">Query Audit Logging</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1 current_section "><a href="javascript: void(0);">SQL Reference</a></li>
          <ul class="current_section">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/sql-reference-introduction/">SQL Reference Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Data Types</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/supported-data-types/">Supported Data Types</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/date-time-and-timestamp/">Date, Time, and Timestamp</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/handling-different-data-types/">Handling Different Data Types</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/lexical-structure/">Lexical Structure</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/operators/">Operators</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">SQL Functions</a></li>
              <ul style="">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/about-sql-function-examples/">About SQL Function Examples</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/math-and-trig/">Math and Trig</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/data-type-conversion/">Data Type Conversion</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/data-type-functions/">Data Type Functions</a></li>
              
                <li class="toctree-l3 current"><a class="reference internal" href="/zh/docs/date-time-functions-and-arithmetic/">Date/Time Functions and Arithmetic</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/string-manipulation/">String Manipulation</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/aggregate-and-aggregate-statistical/">Aggregate and Aggregate Statistical</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/functions-for-handling-nulls/">Functions for Handling Nulls</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/phonetic-functions/">Phonetic Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/string-distance-functions/">String Distance Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/cryptography-functions/">Cryptography Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/sql-dialect-compatibility-functions/">SQL dialect compatibility functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/gis-functions/">GIS functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/time-series-analysis-functions/">Time Series Analysis Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/ip-networking-functions/">IP Networking functions</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">SQL Window Functions</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/sql-window-functions-introduction/">SQL Window Functions Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/aggregate-window-functions/">Aggregate Window Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/ranking-window-functions/">Ranking Window Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/value-window-functions/">Value Window Functions</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/sql-window-functions-examples/">SQL Window Functions Examples</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Nested Data Functions</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/nested-data-limitations/">Nested Data Limitations</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/flatten/">FLATTEN</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/kvgen/">KVGEN</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/repeated-count/">REPEATED_COUNT</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/repeated-contains/">REPEATED_CONTAINS</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/query-directory-functions/">Query Directory Functions</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">SQL Commands</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/supported-sql-commands/">Supported SQL Commands</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/analyze-table-refresh-metadata/">ANALYZE TABLE REFRESH METADATA</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/analyze-table-compute-statistics/">ANALYZE TABLE COMPUTE STATISTICS</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/set/">SET</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/refresh-table-metadata/">REFRESH TABLE METADATA</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/reset/">RESET</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/alter-system/">ALTER SYSTEM</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/create-or-replace-schema/">CREATE OR REPLACE SCHEMA</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/create-table-as-ctas/">CREATE TABLE AS (CTAS)</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/create-temporary-table-as-cttas/">CREATE TEMPORARY TABLE AS (CTTAS)</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/create-function-using-jar/">CREATE FUNCTION USING JAR</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/partition-by-clause/">PARTITION BY Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/create-view/">CREATE VIEW</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/describe/">DESCRIBE</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drop-function-using-jar/">DROP FUNCTION USING JAR</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drop-table/">DROP TABLE</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drop-view/">DROP VIEW</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/explain/">EXPLAIN</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/lateral-join/">LATERAL Join</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/select/">SELECT</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/select-list/">SELECT List</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/from-clause/">FROM Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/group-by-clause/">GROUP BY Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/having-clause/">HAVING Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/limit-clause/">LIMIT Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/offset-clause/">OFFSET Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/order-by-clause/">ORDER BY Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/union-set-operator/">UNION Set Operator</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/where-clause/">WHERE Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/with-clause/">WITH Clause</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/show-databases-and-show-schemas/">SHOW DATABASES and SHOW SCHEMAS</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/show-files/">SHOW FILES</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/show-tables/">SHOW TABLES</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/use/">USE</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">SQL Conditional Expressions</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/case/">CASE</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/reserved-keywords/">Reserved Keywords</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/sql-extensions/">SQL Extensions</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Data Sources and File Formats</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/data-sources-and-file-formats-introduction/">Data Sources and File Formats Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/hive-to-drill-data-type-mapping/">Hive-to-Drill Data Type Mapping</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/deploying-and-using-a-hive-udf/">Deploying and Using a Hive UDF</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/parquet-format/">Parquet Format</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/logfile-plugin/">Logfile Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/json-data-model/">JSON Data Model</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/text-files-csv-tsv-psv/">Text Files: CSV, TSV, PSV</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/sequence-files/">Sequence Files</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/httpd-format-plugin/">HTTPD Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/image-metadata-format-plugin/">Image Metadata Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/syslog-format-plugin/">Syslog Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/ltsv-format-plugin/">LTSV Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/spss-format-plugin/">SPSS Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/esri-shapefile-format-plugin/">ESRI Shapefile Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/excel-format-plugin/">Excel Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/hdf5-format-plugin/">HDF5 Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/xml-format-plugin/">XML Format Plugin</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/sas-format-plugin/">SAS Format Plugin</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Develop Custom Functions</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/develop-custom-functions-introduction/">Develop Custom Functions Introduction</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/developing-a-simple-function/">Developing a Simple Function</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/tutorial-develop-a-simple-function/">Tutorial: Develop a Simple Function</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/developing-an-aggregate-function/">Developing an Aggregate Function</a></li>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Adding Custom Functions to Drill</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/adding-custom-functions-to-drill-introduction/">Adding Custom Functions to Drill Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/manually-adding-custom-functions-to-drill/">Manually Adding Custom Functions to Drill</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/creating-custom-authenticators/">Creating Custom Authenticators</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/dynamic-udfs/">Dynamic UDFs</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/using-custom-functions-in-queries/">Using Custom Functions in Queries</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/custom-function-interfaces/">Custom Function Interfaces</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a class="reference internal" href="/zh/docs/troubleshooting/">Troubleshooting</a></li>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Developer Information</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">REST API</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/rest-api-introduction/">REST API Introduction</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/submitting-queries-from-the-rest-api-when-impersonation-is-enabled-and-authentication-is-disabled/">Submitting Queries from the REST API when Impersonation is Enabled and Authentication is Disabled</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/use-postman-to-run-sql-queries-on-drill-data-sources/">Use Postman to Run SQL Queries on Drill Data Sources</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Develop Drill</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/compiling-drill-from-source/">Compiling Drill from Source</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/useful-information-for-drill-developers/">Useful Information for Drill Developers</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Contribute to Drill</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/apache-drill-contribution-guidelines/">Apache Drill Contribution Guidelines</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/apache-drill-contribution-ideas/">Apache Drill Contribution Ideas</a></li>
              
            </ul>
            
          
            
              <li class="toctree-l2"><a href="javascript: void(0);">Design Docs</a></li>
              <ul style="display: none">
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/drill-plan-syntax/">Drill Plan Syntax</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/rpc-overview/">RPC Overview</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/query-stages/">Query Stages</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/useful-research/">Useful Research</a></li>
              
                <li class="toctree-l3"><a class="reference internal" href="/zh/docs/value-vectors/">Value Vectors</a></li>
              
            </ul>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Release Notes</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-19-0-release-notes/">Apache Drill 1.19.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-18-0-release-notes/">Apache Drill 1.18.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-17-0-release-notes/">Apache Drill 1.17.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-16-0-release-notes/">Apache Drill 1.16.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-15-0-release-notes/">Apache Drill 1.15.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-14-0-release-notes/">Apache Drill 1.14.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-13-0-release-notes/">Apache Drill 1.13.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-12-0-release-notes/">Apache Drill 1.12.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-11-0-release-notes/">Apache Drill 1.11.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-10-0-release-notes/">Apache Drill 1.10.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-9-0-release-notes/">Apache Drill 1.9.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-8-0-release-notes/">Apache Drill 1.8.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-7-0-release-notes/">Apache Drill 1.7.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-6-0-release-notes/">Apache Drill 1.6.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-5-0-release-notes/">Apache Drill 1.5.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-4-0-release-notes/">Apache Drill 1.4.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-3-0-release-notes/">Apache Drill 1.3.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-2-0-release-notes/">Apache Drill 1.2.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-1-0-release-notes/">Apache Drill 1.1.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-1-0-0-release-notes/">Apache Drill 1.0.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-9-0-release-notes/">Apache Drill 0.9.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-8-0-release-notes/">Apache Drill 0.8.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-7-0-release-notes/">Apache Drill 0.7.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-6-0-release-notes/">Apache Drill 0.6.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-5-0-release-notes/">Apache Drill 0.5.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-0-4-0-release-notes/">Apache Drill 0.4.0 Release Notes</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/apache-drill-m1-release-notes-apache-drill-alpha/">Apache Drill M1 Release Notes (Apache Drill Alpha)</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Sample Datasets</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/enron-emails/">Enron Emails</a></li>
            
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/wikipedia-edit-history/">Wikipedia Edit History</a></li>
            
          
          </ul>
        
      
        
          <li class="toctree-l1"><a class="reference internal" href="/zh/docs/project-bylaws/">Project Bylaws</a></li>
        
      
        
          <li class="toctree-l1"><a href="javascript: void(0);">Ecosystem</a></li>
          <ul style="display: none">
          
            
              <li class="toctree-l2"><a class="reference internal" href="/zh/docs/using-saiku-analytics-with-apache-drill/">Using Saiku Analytics with Apache Drill</a></li>
            
          
          </ul>
        
      
      </ul>

    </div>
  </div>
</aside>


<nav class="breadcrumbs">
  <li><a href="/zh/docs/">Docs</a></li>
  
  
  
    <li><a href="/zh/docs/sql-reference/">SQL Reference</a></li>
  
    <li><a href="/zh/docs/sql-functions/">SQL Functions</a></li>
  
  <li>Date/Time Functions and Arithmetic</li>
</nav>


<div class="main-content-wrapper">
  <div class="main-content">

    
      <a class="edit-link" href="https://github.com/apache/drill-site/blob/master/_docs/en/sql-reference/sql-functions/030-date-time-functions-and-arithmetic.md" target="_blank"><i class="fa fa-pencil-square-o"></i></a>
    

    <div class="int_title left">
      <h1>Date/Time Functions and Arithmetic</h1>

    </div>

    <!-- jt: we don't need to display a last-modified date on each page to users
    
    --> 

    <div class="int_text" align="left">
      
        <p>In addition to the TO_DATE, TO_TIME, and TO_TIMESTAMP functions, Drill supports a number of other date/time functions and arithmetic operators for use with dates, times, and intervals. Drill supports time functions based on the Gregorian calendar and in the range 1971 to 2037.</p>

<p>This section covers the Drill <a href="/zh/docs/data-type-conversion/#time-zone-limitation">time zone limitation</a> and defines the following date/time functions:</p>

<table>
  <thead>
    <tr>
      <th><strong>Function</strong></th>
      <th><strong>Return Type</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#age">AGE(TIMESTAMP)</a></td>
      <td>INTERVALDAY or INTERVALYEAR</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#extract">EXTRACT(field from time_expression)</a></td>
      <td>DOUBLE</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">CURRENT_DATE</a></td>
      <td>DATE</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">CURRENT_TIME</a></td>
      <td>TIME</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">CURRENT_TIMESTAMP</a></td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#date_add">DATE_ADD</a></td>
      <td>DATE, TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#date_diff">DATE_DIFF</a></td>
      <td>DATE, TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#date_part">DATE_PART</a></td>
      <td>DOUBLE</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#date_sub">DATE_SUB</a></td>
      <td>DATE, TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">LOCALTIME</a></td>
      <td>TIME</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">LOCALTIMESTAMP</a></td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">NOW</a></td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#other-date-and-time-functions">TIMEOFDAY</a></td>
      <td>VARCHAR</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#unix_timestamp">UNIX_TIMESTAMP</a></td>
      <td>BIGINT</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#nearestdate">NEARESTDATE</a>**</td>
      <td>TIMESTAMP</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#timestampadd">TIMESTAMPADD</a>*</td>
      <td>Inferred based on unit of time</td>
    </tr>
    <tr>
      <td><a href="/zh/docs/date-time-functions-and-arithmetic/#timestampdiff">TIMESTAMPDIFF</a>*</td>
      <td>Inferred based on unit of time</td>
    </tr>
  </tbody>
</table>

<p>*Supported in Drill 1.15 and later.
**Supported in Drill 1.16 and later.</p>

<h2 id="age">AGE</h2>
<div class="admonition important">
  <p class="first admonition-title">Important</p>
  <p class="last"> DRILL-7926: this function is buggy in the current release.  Please make use of alternative date functions until the mentioned issue is resolved.   </p>
</div>

<p>Returns the interval between two timestamps or subtracts a timestamp from midnight of the current date.</p>

<h3 id="age-syntax">AGE Syntax</h3>

<p><code class="language-plaintext highlighter-rouge">AGE (timestamp[, timestamp])</code></p>

<p><em>timestamp</em> is the data and time formatted as shown in the following examples.</p>

<h3 id="age-usage-notes">AGE Usage Notes</h3>
<p>Cast string arguments to timestamp to include time data in the calculations of the interval.</p>

<h3 id="age-examples">AGE Examples</h3>

<p>Find the interval between midnight today, April 3, 2015, and June 13, 1957.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT AGE('1957-06-13') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| P703M23D   |
|------------|
1 row selected (0.064 seconds)
</code></pre></div></div>

<p>Find the interval between midnight today, May 21, 2015, and hire dates of employees 578 and 761 in the <a href="/zh/docs/querying-json-files/"><code class="language-plaintext highlighter-rouge">employee.json</code></a> file installed with Drill. The file is installed with Drill and located in the Drill classpath.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT AGE(CAST(hire_date AS TIMESTAMP)) FROM cp.`employee.json` where employee_id IN( '578','761');
|------------------|
|      EXPR$0      |
|------------------|
| P236MT25200S     |
| P211M19DT25200S  |
|------------------|
2 rows selected (0.121 seconds)
</code></pre></div></div>

<p>Find the interval between 11:10:10 PM on January 1, 2001 and 10:10:10 PM on January 1, 2001.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT AGE(CAST('2010-01-01 10:10:10' AS TIMESTAMP), CAST('2001-01-01 11:10:10' AS TIMESTAMP)) FROM (VALUES(1));
|------------------|
|      EXPR$0      |
|------------------|
| P109M16DT82800S  |
|------------------|
1 row selected (0.122 seconds)
</code></pre></div></div>

<p>For information about how to read the interval data, see the <a href="/zh/docs/date-time-and-timestamp/#intervalyear-and-intervalday">Interval section</a>.</p>

<h2 id="date_add">DATE_ADD</h2>
<p>Returns the sum of a date/time and a number of days/hours, or of a date/time and date/time interval.</p>

<h3 id="date_add-syntax">DATE_ADD Syntax</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">DATE_ADD(keyword literal, integer)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_ADD(keyword literal, interval expr)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_ADD(column, integer)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_ADD(column, interval expr)</code></li>
</ul>

<p><em>keyword</em> is the word date, time, or timestamp.
<em>literal</em> is a date, time, or timestamp literal.  For example, a date in yyyy-mm-dd format enclosed in single quotation marks.
<em>integer</em> is a number of days to add to the date/time.
<em>column</em> is date, time, or timestamp data in a data source column.
<em>interval</em> is the keyword interval.
<em>expr</em> is an interval expression, such as the name of a data source column containing interval data.</p>

<h3 id="date_add-examples">DATE_ADD Examples</h3>

<p>The following examples show how to use the syntax variations.</p>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_ADD(keyword literal, integer)</code> Syntax Example</strong></p>

<p>Add two days to today’s date May 15, 2015.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(date '2015-05-15', 2) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 2015-05-17 |
|------------|
1 row selected (0.07 seconds)
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_ADD(keyword literal, interval expr)</code> Syntax Example</strong></p>

<p>Using the example data from the <a href="/zh/docs/data-type-conversion/#casting-intervals">“Casting Intervals”</a> section, add intervals from the <code class="language-plaintext highlighter-rouge">intervals.json</code> file to a literal timestamp. Create an interval expression that casts the INTERVALDAY_col column, which contains P1D, P2D, and P3D, to a timestamp.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(timestamp '2015-04-15 22:55:55', CAST(INTERVALDAY_col as interval second)) FROM dfs.`/Users/drilluser/apache-drill-1.0.0/intervals.json`;
|------------------------|
|         EXPR$0         |
|------------------------|
| 2015-04-16 22:55:55.0  |
| 2015-04-17 22:55:55.0  |
| 2015-04-18 22:55:55.0  |
|------------------------|
3 rows selected (0.105 seconds)
</code></pre></div></div>

<p>The query output is the sum of the timestamp and 1, 2, and 3 days corresponding to P1D, P2D, and P3D.</p>

<p><strong>DATE_ADD(column, integer) Syntax Example</strong></p>

<p>Add two days to the value in the birth_date column.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(CAST(birth_date AS date), 2) FROM cp.`employee.json` LIMIT 1;
|-------------|
|   EXPR$0    |
|-------------|
| 1961-08-28  |
|-------------|
1 row selected (0.209 seconds)
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_ADD(column, interval expr)</code> Syntax Example</strong></p>

<p>Add a 10 hour interval to the hire dates of employees listed in the <code class="language-plaintext highlighter-rouge">employee.json</code> file, which Drill includes in the installation.</p>

<ol>
  <li>
    <p>Take a look at the employee data:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM cp.`employee.json` LIMIT 1;
 |--------------|---------------|-------------|------------|--------------|-----------------|-----------|----------------|-------------|------------------------|----------|----------------|------------------|-----------------|---------|--------------------|
 | employee_id  |   full_name   | first_name  | last_name  | position_id  | position_title  | store_id  | department_id  | birth_date  |       hire_date        |  salary  | supervisor_id  | education_level  | marital_status  | gender  |  management_role   |
 |--------------|---------------|-------------|------------|--------------|-----------------|-----------|----------------|-------------|------------------------|----------|----------------|------------------|-----------------|---------|--------------------|
 | 1            | Sheri Nowmer  | Sheri       | Nowmer     | 1            | President       | 0         | 1              | 1961-08-26  | 1994-12-01 00:00:00.0  | 80000.0  | 0              | Graduate Degree  | S               | F       | Senior Management  |
 |--------------|---------------|-------------|------------|--------------|-----------------|-----------|----------------|-------------|------------------------|----------|----------------|------------------|-----------------|---------|--------------------|
 1 row selected (0.137 seconds)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Look at the hire_dates for the employee 578 and 761 in <code class="language-plaintext highlighter-rouge">employee.json</code>.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT hire_date FROM cp.`employee.json` where employee_id IN( '578','761');
 |------------------------|
 |       hire_date        |
 |------------------------|
 | 1996-01-01 00:00:00.0  |
 | 1998-01-01 00:00:00.0  |
 |------------------------|
 2 rows selected (0.135 seconds)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Cast the hire_dates of the employees 578 and 761 to a timestamp, and add 10 hours to the hire_date timestamp. Because Drill reads data from JSON as VARCHAR, you need to cast the hire_date to the TIMESTAMP type.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT DATE_ADD(CAST(hire_date AS TIMESTAMP), interval '10' hour) FROM cp.`employee.json` where employee_id IN( '578','761');
 |------------------------|
 |         EXPR$0         |
 |------------------------|
 | 1996-01-01 10:00:00.0  |
 | 1998-01-01 10:00:00.0  |
 |------------------------|
 2 rows selected (0.172 seconds)
</code></pre></div>    </div>
  </li>
</ol>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_ADD(keyword literal, integer)</code> Syntax Example</strong></p>

<p>Add 1 year and 1 month to the timestamp 2015-04-15 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(timestamp '2015-04-15 22:55:55', interval '1-2' year to month) FROM (VALUES(1));
|------------------------|
|         EXPR$0         |
|------------------------|
| 2016-06-15 22:55:55.0  |
|------------------------|
1 row selected (0.106 seconds)
</code></pre></div></div>

<p>Add 1 day 2 and 1/2 hours and 45.100 seconds to the time 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(time '22:55:55', interval '1 2:30:45.100' day to second) FROM (VALUES(1));
|---------------|
|    EXPR$0     |
|---------------|
| 01:26:40.100  |
|---------------|
1 row selected (0.106 seconds)
</code></pre></div></div>

<h2 id="date_diff">DATE_DIFF</h2>
<p>Returns the difference of a date/time and a number of days/hours, or of a date/time and date/time interval.</p>

<p><strong>NOTE:</strong> You can use the Hive <code class="language-plaintext highlighter-rouge">DATEDIFF()</code> function in Drill with string values, as shown:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATEDIFF('1996-03-01', '1997-02-10 17:32:00.0'), TIMEOFDAY() FROM (VALUES(1));
|---------|----------------------------------------------|
| EXPR$0  |                    EXPR$1                    |
|---------|----------------------------------------------|
| -346    | 2019-01-15 14:54:21.455 America/Los_Angeles  |
|---------|----------------------------------------------|
</code></pre></div></div>

<p>However, for date and timestamp values, use the <code class="language-plaintext highlighter-rouge">DATE_DIFF</code> function and convert the interval returned to a number, as shown:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TO_NUMBER(DATE_DIFF(DATE '1996-03-01', TIMESTAMP '1997-02-10 17:32:00.0'), '#'), TIMEOFDAY() FROM (VALUES(1));
|---------|----------------------------------------------|
| EXPR$0  |                    EXPR$1                    |
|---------|----------------------------------------------|
| -346.0  | 2019-01-15 14:52:15.247 America/Los_Angeles  |
|---------|----------------------------------------------|
</code></pre></div></div>

<h3 id="date_diff-syntax">DATE_DIFF Syntax</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">DATE_DIFF(keyword literal, integer)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_DIFF(keyword literal, interval expr)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_DIFF(column, integer)</code></li>
  <li><code class="language-plaintext highlighter-rouge">DATE_DIFF(column, interval expr)</code></li>
</ul>

<p><em>keyword</em> is the word date, time, or timestamp.
<em>literal</em> is a date, time, or timestamp literal.  For example, a date in yyyy-mm-dd format enclosed in single quotation marks.
<em>integer</em> is a number of days to subtract from the date/time.
<em>column</em> is date, time, or timestamp data in a data source column.
<em>interval</em> is the keyword interval.
<em>expr</em> is an interval expression, such as the name of a data source column containing interval data.</p>

<h3 id="date_diff-examples">DATE_DIFF Examples</h3>
<p>The following examples show how to use the syntax variations.</p>

<p><strong>DATE_DIFF(keyword literal, integer) Syntax Example</strong></p>

<p>Subtract two days from the date May 15, 2015.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(date '2015-05-15', 2) FROM (VALUES(1));
|-------------|
|   EXPR$0    |
|-------------|
| 2015-05-13  |
|-------------|
</code></pre></div></div>

<p><strong>DATE_DIFF(keyword literal, interval expr) Syntax Example</strong></p>

<p>Using the example data from the <a href="/zh/docs/data-type-conversion/#casting-intervals">“Casting Intervals”</a>  section, subtract intervals from the <code class="language-plaintext highlighter-rouge">intervals.json</code> file from a literal timestamp. Create an interval expression that casts the INTERVALDAY_col column, which contains P1D, P2D, and P3D, to a timestamp.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(timestamp '2015-04-15 22:55:55', CAST(INTERVALDAY_col as interval second)) FROM dfs.`/home/bee/intervals.json`;
|------------------------|
|         EXPR$0         |
|------------------------|
| 2015-04-14 22:55:55.0  |
| 2015-04-13 22:55:55.0  |
| 2015-04-12 22:55:55.0  |
|------------------------|
</code></pre></div></div>

<p>The query output is the difference of the timestamp and 1, 2, and 3 days corresponding to P1D, P2D, and P3D.</p>

<p><strong>DATE_DIFF(column, integer) Syntax Example</strong></p>

<p>Subtract two days from the value in the birth_date column.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(CAST(birth_date AS date), 2) as a FROM cp.`employee.json` LIMIT 1;
|-------------|
|      a      |
|-------------|
| 1961-08-24  |
|-------------|
</code></pre></div></div>

<p><strong>DATE_DIFF(column, interval expr) Syntax Example</strong></p>

<p>Subtract a 10 hour interval from the hire dates of employees listed in the <code class="language-plaintext highlighter-rouge">employee.json</code> file, which Drill includes in the installation.</p>

<p>Cast the hire_dates of the employees 578 and 761 to a timestamp, and subtract 10 hours from the hire_date timestamp. Drill reads data from JSON as VARCHAR; therefore, cast the hire_date to the TIMESTAMP type.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(CAST(hire_date AS TIMESTAMP), interval '10' hour) FROM cp.`employee.json` where employee_id IN( '578','761');
|------------------------|
|         EXPR$0         |
|------------------------|
| 1995-12-31 14:00:00.0  |
| 1997-12-31 14:00:00.0  |
|------------------------|
</code></pre></div></div>

<p><strong>DATE_DIFF(keyword literal, integer) Syntax Example</strong></p>

<p>Subtract 1 year and 2 months from the timestamp 2015-04-15 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(timestamp '2015-04-15 22:55:55', interval '1-2' year to month) FROM (VALUES(1));
|------------------------|
|         EXPR$0         |
|------------------------|
| 2014-02-15 22:55:55.0  |
|------------------------|
</code></pre></div></div>

<p>Subtract 1 day 2 and 1/2 hours and 45.100 seconds from the time 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_DIFF(time '22:55:55', interval '1 2:30:45.100' day to second) FROM (VALUES(1));
|---------------|
|    EXPR$0     |
|---------------|
| 20:25:09.900  |
|---------------|
</code></pre></div></div>

<h2 id="date_part">DATE_PART</h2>
<p>Returns a field of a date, time, timestamp, or interval.</p>

<h3 id="date_part-syntax">DATE_PART Syntax</h3>

<p><code class="language-plaintext highlighter-rouge">date_part(keyword, expression)</code></p>

<p><em>keyword</em> is year, month, day, hour, minute, or second enclosed in single quotation marks.
<em>expression</em> is date, time, timestamp, or interval literal enclosed in single quotation marks.</p>

<h3 id="date_part-usage-notes">DATE_PART Usage Notes</h3>
<p>Use Unix Epoch timestamp in milliseconds as the expression to get the field of a timestamp.</p>

<h3 id="date_part-examples">DATE_PART Examples</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_PART('day', '2015-04-02') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 2          |
|------------|
1 row selected (0.098 seconds)

SELECT DATE_PART('hour', '23:14:30.076') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 23         |
|------------|
1 row selected (0.088 seconds)
</code></pre></div></div>

<p>Return the day part of the one year, 2 months, 10 days interval.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_PART('day', '1:2:10') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 10         |
|------------|
1 row selected (0.069 seconds)
</code></pre></div></div>

<h2 id="date_sub">DATE_SUB</h2>
<p>Returns the difference between a date/time and a number of days/hours, or between a date/time and date/time interval.</p>

<h3 id="date_sub-syntax">DATE_SUB Syntax</h3>

<p><code class="language-plaintext highlighter-rouge">DATE_SUB(keyword literal, integer)</code>
<code class="language-plaintext highlighter-rouge">DATE_SUB(keyword literal, interval expr)</code>
<code class="language-plaintext highlighter-rouge">DATE_SUB(column, integer)</code>
<code class="language-plaintext highlighter-rouge">DATE_SUB(column, interval expr)</code></p>

<p><em>keyword</em> is the word date, time, or timestamp.
<em>literal</em> is a date, time, or timestamp literal. For example, a date in yyyy-mm-dd format enclosed in single quotation marks.
<em>integer</em> is a number of days to subtract from the date, time, or timestamp.
<em>column</em> is date, time, or timestamp data in the data source.
<em>interval</em> is the keyword interval.
<em>expr</em> is an interval expression, such as the name of a data source column containing interval data.</p>

<h3 id="date_sub-examples">DATE_SUB Examples</h3>
<p>The following examples show how to apply the syntax variations.</p>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_SUB(keyword literal, integer)</code> Syntax Example</strong></p>

<p>Subtract two days from today’s date May 15, 2015.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(date '2015-05-15', 2) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 2015-05-13 |
|------------|
1 row selected (0.088 seconds)
</code></pre></div></div>

<p>Subtact two months from April 15, 2015.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(date '2015-04-15', interval '2' month) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 2015-02-15 |
|------------|
1 row selected (0.088 seconds)
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_SUB(keyword literal, interval expr)</code> Syntax Example</strong></p>

<p>Subtract 10 hours from the timestamp 2015-04-15 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(timestamp '2015-04-15 22:55:55', interval '10' hour) FROM (VALUES(1));
|------------------------|
|         EXPR$0         |
|------------------------|
| 2015-04-15 12:55:55.0  |
|------------------------|
1 row selected (0.108 seconds)
</code></pre></div></div>

<p>Subtract 10 hours from the time 22 hours, 55 minutes, 55 seconds.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(time '22:55:55', interval '10' hour) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 12:55:55   |
|------------|
1 row selected (0.079 seconds)
</code></pre></div></div>

<p>Subtract 1 year and 1 month from the timestamp 2015-04-15 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(timestamp '2015-04-15 22:55:55', interval '1-2' year to month) FROM (VALUES(1));
|------------------------|
|         EXPR$0         |
|------------------------|
| 2014-02-15 22:55:55.0  |
|------------------------|
1 row selected (0.108 seconds)
</code></pre></div></div>

<p>Subtract 1 day, 2 and 1/2 hours, and 45.100 seconds from the time 22:55:55.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_ADD(time '22:55:55', interval '1 2:30:45.100' day to second) FROM (VALUES(1));
|---------------|
|    EXPR$0     |
|---------------|
| 01:26:40.100  |
|---------------|
1 row selected (0.095 seconds)
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_SUB(column, integer)</code> Syntax Example</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(CAST(birth_date AS date), 2) FROM cp.`employee.json` LIMIT 1;
|-------------|
|   EXPR$0    |
|-------------|
| 1961-08-24  |
|-------------|
1 row selected (0.158 seconds)
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">DATE_SUB(column, interval expr)</code> Syntax Example</strong></p>

<p>The <code class="language-plaintext highlighter-rouge">employee.json</code> file, which Drill includes in the installation, lists the hire dates of employees. Cast the hire_dates of the employees 578 and 761 to a timestamp, and add 10 hours to the hire_date timestamp. Because Drill reads data from JSON as VARCHAR, you need to cast the hire_date to the TIMESTAMP type.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DATE_SUB(CAST(hire_date AS TIMESTAMP), interval '10' hour) FROM cp.`employee.json` WHERE employee_id IN( '578','761');
|------------------------|
|         EXPR$0         |
|------------------------|
| 1995-12-31 14:00:00.0  |
| 1997-12-31 14:00:00.0  |
|------------------------|
2 rows selected (0.161 seconds)
</code></pre></div></div>

<h2 id="other-date-and-time-functions">Other Date and Time Functions</h2>

<p>The following examples show how to use these functions:</p>

<ul>
  <li>CURRENT_DATE</li>
  <li>CURRENT_TIME</li>
  <li>CURRENT_TIMESTAMP</li>
  <li>LOCALTIME</li>
  <li>LOCALTIMESTAMP</li>
  <li>NOW</li>
  <li>
    <p>TIMEOFDAY</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  SELECT CURRENT_DATE FROM (VALUES(1));
  |--------------|
  | current_date |
  |--------------|
  | 2015-04-02   |
  |--------------|
  1 row selected (0.077 seconds)

  SELECT CURRENT_TIME FROM (VALUES(1));
  |--------------|
  | current_time |
  |--------------|
  | 14:32:04.751 |
  |--------------|
  1 row selected (0.073 seconds)

  SELECT CURRENT_TIMESTAMP FROM (VALUES(1));
  |--------------------------|
  |    CURRENT_TIMESTAMP     |
  |--------------------------|
  | 2015-05-17 22:45:55.848  |
  |--------------------------|
  1 row selected (0.109 seconds)

  SELECT LOCALTIME FROM (VALUES(1));

  |---------------|
  |   LOCALTIME   |
  |---------------|
  | 22:46:19.656  |
  |---------------|
  1 row selected (0.105 seconds)

  SELECT LOCALTIMESTAMP FROM (VALUES(1));

  |--------------------------|
  |      LOCALTIMESTAMP      |
  |--------------------------|
  | 2015-05-17 22:46:47.944  |
  |--------------------------|
  1 row selected (0.08 seconds)

  SELECT NOW() FROM (VALUES(1));
  |--------------------------|
  |          EXPR$0          |
  |--------------------------|
  | 2015-05-17 22:47:11.008  |
  |--------------------------|
  1 row selected (0.085 seconds)
</code></pre></div>    </div>
  </li>
</ul>

<p>If you set up Drill for <a href="/zh/docs/data-type-conversion/#time-zone-limitation">UTC time</a>, TIMEOFDAY returns the result for the UTC time zone.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMEOFDAY() FROM (VALUES(1));
|-----------------------------|
|           EXPR$0            |
|-----------------------------|
| 2015-04-02 22:05:02.424 UTC |
|-----------------------------|
1 row selected (1.191 seconds)
</code></pre></div></div>

<p>If you did not set up Drill for UTC time, TIMEOFDAY returns the local date and time with time zone information.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMEOFDAY() FROM (VALUES(1));
|----------------------------------------------|
|                    EXPR$0                    |
|----------------------------------------------|
| 2015-05-17 22:47:38.012 America/Los_Angeles  |
|----------------------------------------------|
1 row selected (0.08 seconds)
</code></pre></div></div>

<h2 id="extract">EXTRACT</h2>

<p>Returns a component of a timestamp, time, date, or interval.</p>

<h3 id="extract-syntax">EXTRACT Syntax</h3>

<p><code class="language-plaintext highlighter-rouge">EXTRACT (extract_expression)</code></p>

<p><em>extract_expression</em> is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>component FROM (timestamp | time | date | interval)
</code></pre></div></div>

<p><em>component</em> is one of the following time units: year, month, day, hour, minute, second.</p>

<h3 id="extract-usage-notes">EXTRACT Usage Notes</h3>

<p>The extract function supports the following time units: YEAR, MONTH, DAY, HOUR, MINUTE, SECOND.</p>

<h3 id="extract-examples">EXTRACT Examples</h3>

<p>On the third day of the month, run the following function:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(day FROM NOW()), EXTRACT(day FROM CURRENT_DATE) FROM (VALUES(1));

|------------|------------|
|   EXPR$0   |   EXPR$1   |
|------------|------------|
| 3          | 3          |
|------------|------------|
1 row selected (0.208 seconds)
</code></pre></div></div>

<p>At 8:00 am, extract the hour from the value of CURRENT_DATE.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(hour FROM CURRENT_DATE) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 8          |
|------------|
</code></pre></div></div>

<p>What is the hour component of this time: 17:12:28.5?</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(hour FROM TIME '17:12:28.5') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 17         |
|------------|
1 row selected (0.056 seconds)
</code></pre></div></div>

<p>What is the seconds component of this timestamp: 2001-02-16 20:38:40</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(SECOND FROM TIMESTAMP '2001-02-16 20:38:40') FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 40.0       |
|------------|
1 row selected (0.062 seconds)
</code></pre></div></div>

<h2 id="date-time-and-interval-arithmetic-functions">Date, Time, and Interval Arithmetic Functions</h2>

<p>Is the day returned from the NOW function the same as the day returned from the CURRENT_DATE function?</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(day FROM NOW()) = EXTRACT(day FROM CURRENT_DATE) FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| true       |
|------------|
1 row selected (0.092 seconds)
</code></pre></div></div>

<p>Every 23 hours, a 4 hour task started. What time does the task end?</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIME '04:00:00' + interval '23:00:00' hour to second FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| 03:00:00   |
|------------|
1 row selected (0.097 seconds)
</code></pre></div></div>

<p>Is the time 2:00 PM?</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT EXTRACT(hour FROM CURRENT_DATE) = 2 FROM (VALUES(1));
|------------|
|   EXPR$0   |
|------------|
| false      |
|------------|
1 row selected (0.033 seconds)
</code></pre></div></div>

<h2 id="unix_timestamp">UNIX_TIMESTAMP</h2>

<p>Returns UNIX Epoch time, which is the number of seconds elapsed since January 1, 1970.</p>

<h3 id="unix_timestamp-syntax">UNIX_TIMESTAMP Syntax</h3>

<p><code class="language-plaintext highlighter-rouge">UNIX_TIMESTAMP()</code>
<code class="language-plaintext highlighter-rouge">UNIX_TIMESTAMP(string date)</code>
<code class="language-plaintext highlighter-rouge">UNIX_TIMESTAMP(string date, string pattern)</code></p>

<p>These functions perform the following operations, respectively:</p>

<ul>
  <li>Gets current Unix timestamp in seconds if given no arguments.</li>
  <li>Converts the time string in format yyyy-MM-dd HH:mm:ss to a Unix timestamp in seconds using the default timezone and locale.</li>
  <li>Converts the time string with the given pattern to a Unix time stamp in seconds.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT UNIX_TIMESTAMP() FROM (VALUES(1));
|-------------|
|   EXPR$0    |
|-------------|
| 1435711031  |
|-------------|
1 row selected (0.749 seconds)

SELECT UNIX_TIMESTAMP('2009-03-20 11:15:55') FROM (VALUES(1));
|-------------|
|   EXPR$0    |
|-------------|
| 1237572955  |
|-------------|
1 row selected (1.848 seconds)

SELECT UNIX_TIMESTAMP('2009-03-20', 'yyyy-MM-dd') FROM (VALUES(1));
|-------------|
|   EXPR$0    |
|-------------|
| 1237532400  |
|-------------|
1 row selected (0.181 seconds)

SELECT UNIX_TIMESTAMP('2015-05-29 08:18:53.0', 'yyyy-MM-dd HH:mm:ss.SSS') FROM (VALUES(1));
|-------------|
|   EXPR$0    |
|-------------|
| 1432912733  |
|-------------|
1 row selected (0.171 seconds)
</code></pre></div></div>

<h2 id="nearestdate">NEARESTDATE</h2>
<p>Quickly and easily aggregates timestamp data by various units of time.</p>

<p><strong>Note:</strong> Drill 1.16 and later supports the NEARESTDATE function.</p>

<h3 id="nearestdate-syntax">NEARESTDATE Syntax</h3>

<p>NEARESTDATE(<em>column</em>, ‘<em>interval</em>’ )</p>

<h3 id="nearestdate-usage-notes">NEARESTDATE Usage Notes</h3>
<ul>
  <li>Use with COUNT and GROUP BY to aggregate timestamp data.</li>
  <li><em>column</em> is a data source column with timestamp values.</li>
  <li><em>interval</em> is any of the following units of time:
    <ul>
      <li>YEAR</li>
      <li>QUARTER</li>
      <li>MONTH</li>
      <li>WEEK_SUNDAY</li>
      <li>WEEK_MONDAY</li>
      <li>DAY</li>
      <li>HOUR</li>
      <li>HALF_HOUR</li>
      <li>QUARTER_HOUR</li>
      <li>MINUTE</li>
      <li>30SECOND</li>
      <li>15SECOND</li>
      <li>SECOND</li>
    </ul>
  </li>
</ul>

<h3 id="nearestdate-examples">NEARESTDATE Examples</h3>

<p>The following example uses the NEARESTDATE function to aggregate hire dates by year:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT NEARESTDATE(hire_date, 'YEAR' ) AS hireDate, COUNT(*) AS `count` FROM cp.`employee.json` GROUP BY NEARESTDATE(hire_date, 'YEAR');
|-----------------------|-------|
|       hireDate        | count |
|-----------------------|-------|
| 1994-01-01 00:00:00.0 | 23    |
| 1998-01-01 00:00:00.0 | 539   |
| 1996-01-01 00:00:00.0 | 503   |
| 1995-01-01 00:00:00.0 | 12    |
| 1997-01-01 00:00:00.0 | 74    |
| 1993-01-01 00:00:00.0 | 4     |
|-----------------------|-------|
</code></pre></div></div>

<p>The following example applies the NEARESTDATE function to a timestamp value (2019-02-01 07:22:00) and returns the timestamp value for each time unit indicated:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-01 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'YEAR'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_year</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-01 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'QUARTER'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_quarter</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'MONTH'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_month</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'DAY'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_day</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'WEEK_SUNDAY'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_week_sunday</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'WEEK_MONDAY'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_week_monday</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'HOUR'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_hour</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:42:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'HALF_HOUR'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_half_hour</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:48:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'QUARTER_HOUR'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_quarter_hour</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:00'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'MINUTE'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_minute</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:22'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'HALF_MINUTE'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_30second</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:22'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'QUARTER_MINUTE'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_15second</span><span class="p">,</span>
  <span class="n">NEARESTDATE</span><span class="p">(</span> <span class="n">TO_TIMESTAMP</span><span class="p">(</span><span class="s1">'2019-02-15 07:22:31'</span><span class="p">,</span> <span class="s1">'yyyy-MM-dd HH:mm:ss'</span><span class="p">),</span> <span class="s1">'SECOND'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">nearest_second</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|
|     nearest_year      |    nearest_quarter    |     nearest_month     |      nearest_day      |  nearest_week_sunday  |  nearest_week_monday  |     nearest_hour      |   nearest_half_hour   | nearest_quarter_hour  |    nearest_minute     |   nearest_30second    |   nearest_15second    |    nearest_second     |
|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|
| 2019-01-01 00:00:00.0 | 2019-01-01 00:00:00.0 | 2019-02-01 00:00:00.0 | 2019-02-15 00:00:00.0 | 2019-02-10 00:00:00.0 | 2019-02-11 00:00:00.0 | 2019-02-15 07:00:00.0 | 2019-02-15 07:30:00.0 | 2019-02-15 07:45:00.0 | 2019-02-15 07:22:00.0 | 2019-02-15 07:22:00.0 | 2019-02-15 07:22:15.0 | 2019-02-15 07:22:31.0 |
|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|-----------------------|
</code></pre></div></div>

<h2 id="timestampadd">TIMESTAMPADD</h2>
<p>Adds an interval of time, in the given time units, to a datetime expression.</p>

<p><strong>Note:</strong> Drill 1.15 and later supports the TIMESTAMPADD function.</p>

<h3 id="timestampadd-syntax">TIMESTAMPADD Syntax</h3>
<p>TIMESTAMPADD(<em>time_unit, interval, datetime_expression</em>)</p>

<h3 id="timestampadd-usage-notes">TIMESTAMPADD Usage Notes</h3>
<ul>
  <li><em>datetime_expression</em> is a column or literal with date, time, or timestamp values.</li>
  <li><em>time_unit</em> is any of the following: Nanosecond, Microsecond, Second, Minute, Hour, Day, Month, Year, Week, Quarter</li>
  <li><em>interval</em> is the amount of <em>time_unit</em> to add.</li>
  <li>Drill uses the <em>time_unit</em> to infer the return type.</li>
  <li>
    <p>You can include the <code class="language-plaintext highlighter-rouge">SQL_TSI_</code> prefix with the any of the supported time units, as shown:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  SELECT TIMESTAMPADD(SQL_TSI_MINUTE,5,TIME '05:05:05');
  |-----------|
  |  EXPR$0   |
  |-----------|
  | 05:10:05  |
  |-----------|
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="timestampadd-examples">TIMESTAMPADD Examples</h3>

<p>Add three years to a date literal:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMESTAMPADD(YEAR,3,DATE '1982-05-06');
|------------------------|
|         EXPR$0         |
|------------------------|
| 1985-05-06 00:00:00.0  |
|------------------------|
</code></pre></div></div>

<p>Add a quarter (3 months) to the date values in the first column of the dates.csv file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMESTAMPADD(QUARTER, 1, CAST(COLUMNS[0] as date)) q1 FROM dfs.`/quarter/dates.csv`;
|------------------------|
|           q1           |
|------------------------|
| 2018-04-01 00:00:00.0  |
| 2017-05-02 00:00:00.0  |
| 2000-08-06 00:00:00.0  |
|------------------------|
</code></pre></div></div>

<p>Dates in column[0] before applying the TIMESTAMPADD function:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT COLUMNS[0] FROM dfs.`/quarter/dates.csv`;
|-------------|
|   EXPR$0    |
|-------------|
| 2018-01-01  |
| 2017-02-02  |
| 2000-05-06  |
|-------------|
</code></pre></div></div>

<h2 id="timestampdiff">TIMESTAMPDIFF</h2>
<p>Calculates an interval of time, in the given time units, by subtracting <em>datetime_expression1</em> from <em>datetime_expression2</em> (<em>datetime_expression2</em> − <em>datetime_expression1</em>).</p>

<p><strong>Note:</strong> Drill 1.15 and later supports the TIMESTAMPDIFF function.</p>

<h3 id="timestampdiff-syntax">TIMESTAMPDIFF Syntax</h3>
<p>TIMESTAMPDIFF(<em>time_unit, datetime_expression1, datetime_expression2</em>)</p>

<h3 id="timestampdiff-usage-notes">TIMESTAMPDIFF Usage Notes</h3>
<ul>
  <li><em>datetime_expression</em> is a column or literal with date, time, or timestamp values.</li>
  <li><em>time_unit</em> is any of the following: Nanosecond, Microsecond, Second, Minute, Hour, Day, Month, Year, Week, Quarter</li>
  <li>You can include two date expressions, or one date expression with one datetime expression.</li>
  <li>Drill uses the <em>time_unit</em> to infer the return type.</li>
  <li>
    <p>You can include the <code class="language-plaintext highlighter-rouge">SQL_TSI_</code> prefix with the any of the supported time units, as shown:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  SELECT TIMESTAMPDIFF(SQL_TSI_MONTH, DATE '1982-05-06', DATE '2018-12-26');
  |---------|
  | EXPR$0  |
  |---------|
  | 439     |
  |---------|
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="timestampdiff-examples">TIMESTAMPDIFF Examples</h3>

<p>Subtracts the date literal ‘1982-05-06’ from the date literal ‘2018-12-26’ and returns the difference in months:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMESTAMPDIFF(MONTH, DATE'1982-05-06', DATE '2018-12-26');
|---------|
| EXPR$0  |
|---------|
| 439     |
|---------|
</code></pre></div></div>

<p>Subtracts the date literal ‘1970-01-15’ from the dates in the first column of the dates.csv file and returns the difference in seconds:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMESTAMPDIFF(SECOND, DATE '1970-01-15', CAST(COLUMNS[0] as date)) a FROM dfs.`/quarter/dates.csv`
|-------------|
|      a      |
|-------------|
| 1513555200  |
| 1484784000  |
| 956361600   |
|-------------|
</code></pre></div></div>

<p>Subtracts the date in the third column from the date in the first column (columns[0]-columns[2]) of the dates.csv file and returns the difference in seconds:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT TIMESTAMPDIFF(SECOND, CAST(COLUMNS[2] as date), CAST(COLUMNS[0] as date)) a from dfs.`/quarter/dates.csv`;
|------------|
|     a      |
|------------|
| 0          |
| 0          |
| -92016000  |
|------------|
</code></pre></div></div>

    
      
        <div class="doc-nav">
  
  <span class="previous-toc"><a href="/zh/docs/data-type-functions/">← Data Type Functions</a></span><span class="next-toc"><a href="/zh/docs/string-manipulation/">String Manipulation →</a></span>
</div>

    
    </div>
  </div>
</div>

  </div>
  <p class="push"></p>
<div id="footer" class="mw">
<div class="wrapper">
Copyright © 2012-2020 The Apache Software Foundation, licensed under the Apache License, Version 2.0.<br>
Apache and the Apache feather logo are trademarks of The Apache Software Foundation. Other names appearing on the site may be trademarks of their respective owners.<br/><br/>
</div>
</div>

  <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-53379651-1', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-548b2caa33765e8d" async="async"></script>

</body>
</html>
