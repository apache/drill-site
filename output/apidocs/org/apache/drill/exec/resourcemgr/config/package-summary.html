<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>org.apache.drill.exec.resourcemgr.config (Drill : 1.21.2-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.drill.exec.resourcemgr.config">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html#package">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li><a href="#related-package-summary">Related Packages</a>&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package org.apache.drill.exec.resourcemgr.config" class="title">Package org.apache.drill.exec.resourcemgr.config</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">org.apache.drill.exec.resourcemgr.config</span></div>
<section class="package-description" id="package-description">
<div class="block">This package contains the configuration components of ResourceManagement feature in Drill. ResourceManagement will
 have it's own configuration file supporting the similar hierarchy of files as supported by Drill's current
 configuration and supports HOCON format. All the supported files for ResourceManagement is listed in
 <a href="../../../common/config/ConfigConstants.html" title="interface in org.apache.drill.common.config"><code>ConfigConstants</code></a>. However whether the feature is enabled/disabled is still
 controlled by a configuration <a href="../../ExecConstants.html#RM_ENABLED"><code>ExecConstants.RM_ENABLED</code></a> available in the Drill's main
 configuration file. The rm config files will be parsed and loaded only when the feature is enabled. The
 configuration is a hierarchical tree <a href="ResourcePoolTree.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePoolTree</code></a> of
 <a href="ResourcePool.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePool</code></a>. At the top will be the root pool which represents
 the entire resources (only memory in version 1) which is available to ResourceManager to use for admitting queries.
 It is assumed that all the nodes in the Drill cluster is homogeneous and given same amount of memory resources.
 The root pool can be further divided into child ResourcePools to divide the resources among multiple child pools.
 Each child pool get's a resource share from it's parent resource pool. In theory there is no limit on the number
 of ResourcePools that can be configured to divide the cluster resources.
 <p>
   In addition to other parameters defined later root ResourcePool also supports a configuration
 <a href="ResourcePoolTreeImpl.html#ROOT_POOL_QUEUE_SELECTION_POLICY_KEY"><code>ResourcePoolTreeImpl.ROOT_POOL_QUEUE_SELECTION_POLICY_KEY</code></a> which
 helps to select exactly one leaf pool out of all the possible options available for a query. For details please
 see package-info.java of <a href="selectionpolicy/QueueSelectionPolicy.html" title="interface in org.apache.drill.exec.resourcemgr.config.selectionpolicy"><code>QueueSelectionPolicy</code></a>.
 <a href="ResourcePoolTree.html#selectOneQueue(org.apache.drill.exec.ops.QueryContext,org.apache.drill.exec.resourcemgr.NodeResources)"><code>ResourcePoolTree.selectOneQueue(org.apache.drill.exec.ops.QueryContext, org.apache.drill.exec.resourcemgr.NodeResources)</code></a> method is used by parallelizer to get a queue which will be used
 to admit a query. The selected queue resource constraints are used by parallelizer to allocate proper resources
 to a query so that it remains within the bounds.
 </p>
 <p>
   The ResourcePools falls under 2 category:
 <ul>
   <li>Intermediate Pool: As the name suggests all the pools between root and leaf pool falls under this
   category. It helps to navigate a query through the ResourcePoolTree hierarchy to find leaf pools using selectors.
   The intermediate ResourcePool help to subdivide a parent resource pool resource and doesn't have an actual queue
   associated with it. A query will only be executed in a queue associated with a ResourcePool not the ResourcePool
   itself.
   </li>
   <li>Leaf Pool: All the ResourcePools which doesn't have any child pools associated with it are leaf
   ResourcePools. All the leaf pools should have a unique name associated with it and should always have exactly one
   queue configured with it. The queue of a leaf pool is where the queries will be admitted and a resource slice will
   be given to it. All the leaf ResourcePools will collectively comprise of all the resource share available to
   Drill's ResourceManager to allocate to all the queries.
   </li>
 </ul>
 Configurations Supported by ResourcePool:
   <ul>
     <li><a href="ResourcePoolImpl.html#POOL_MEMORY_SHARE_KEY"><code>ResourcePoolImpl.POOL_MEMORY_SHARE_KEY</code></a>: Percentage of
     memory share of parent ResourcePool assigned to this pool</li>
     <li><a href="ResourcePoolImpl.html#POOL_SELECTOR_KEY"><code>ResourcePoolImpl.POOL_SELECTOR_KEY</code></a>: A selector assigned
     to this pool. For details please see package-info.java of
     <a href="selectors/ResourcePoolSelector.html" title="interface in org.apache.drill.exec.resourcemgr.config.selectors"><code>ResourcePoolSelector</code></a>
     </li>
     <li><a href="ResourcePoolImpl.html#POOL_QUEUE_KEY"><code>ResourcePoolImpl.POOL_QUEUE_KEY</code></a>: Queue configuration
     associated with this pool. It should always be configured for a leaf pool only. If configured with an
     intermediate pool then it will be ignored.
     </li>
   </ul>
 </p>
 <p>
   A queue always have 1:1 relationship with a leaf pool. Queries are admitted and executed with a resource slice
   from the queue. It supports following configurations:
   <ul>
     <li><code>QueryQueueConfigImpl.MAX_ADMISSIBLE_KEY</code>: Upper bound on the
     total number of queries that can be admitted inside a queue. After this limit is reached all the queries
     will be moved to waiting state.</li>
     <li><code>QueryQueueConfigImpl.MAX_WAITING_KEY</code>: Limits the
     total number of queries that can be in waiting state inside a queue. After this limit is reached all the new
     queries will be failed immediately.</li>
     <li> <code>QueryQueueConfigImpl.MAX_QUERY_MEMORY_PER_NODE_KEY</code>:
     Limits the maximum memory any query in this queue can consume on any node in the cluster. This is to limit a
     query from a queue to consume all the resources on a node so that other queues query can also have some
     resources available for it. Ideally it's advised that sum of value of this parameter for all queues should not
     exceed the total memory on a node.
     </li>
     <li> <code>QueryQueueConfigImpl.WAIT_FOR_PREFERRED_NODES_KEY</code>: This
     configuration helps to decide if an admitted query in a queue should wait until it has available resources on all
     the nodes assigned to it by planner for its execution. By default it's true. When set to false then for the nodes
     which doesn't have available resources for a query will be replaced with another node with enough resources.
     </li>
   </ul>
 </p>
 Once all the configuration are parsed an in-memory structures are created then for each query planner will select
 a queue where a query can be admitted. The queue selection process happens by traversing the ResourcePoolTree. During
 traversal process the query metadata is evaluated against assigned selector of a ResourcePool. If the selector
 returns true then traversal continues to it's child pools otherwise it stops there and tries another pool. With
 the traversal it finds all the leaf pools which are eligible for admitting the query and store that information in
 <a href="QueueAssignmentResult.html" title="class in org.apache.drill.exec.resourcemgr.config"><code>QueueAssignmentResult</code></a>. Later the selected pools are passed to
 configured QueueSelectionPolicy to select one queue for the query. Planner uses that selected queue's max query
 memory per node parameter to limit resource assignment to all the fragments of a query on a node. After a query is
 planned with resource constraints it is sent to leader of that queue to ask for admission. If admitted the query
 required resources are reserved in global state store and query is executed on the cluster. For details please see
 the design document and functional spec linked in <a href="https://issues.apache.org/jira/browse/DRILL-7026">
 DRILL-7026</a></div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="related-package-summary">
<div class="caption"><span>Related Packages</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Package</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><a href="../package-summary.html">org.apache.drill.exec.resourcemgr</a></div>
<div class="col-last even-row-color">
<div class="block">This package will contain all the components of resource manager in Drill.</div>
</div>
<div class="col-first odd-row-color"><a href="exception/package-summary.html">org.apache.drill.exec.resourcemgr.config.exception</a></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><a href="selectionpolicy/package-summary.html">org.apache.drill.exec.resourcemgr.config.selectionpolicy</a></div>
<div class="col-last even-row-color">
<div class="block">Defines all the selection policy implementation which can be configured with Resource Management.</div>
</div>
<div class="col-first odd-row-color"><a href="selectors/package-summary.html">org.apache.drill.exec.resourcemgr.config.selectors</a></div>
<div class="col-last odd-row-color">
<div class="block">Defines all the Selectors which can be assigned to a ResourcePool in the ResourceManagement configuration.</div>
</div>
<div class="col-first even-row-color"><a href="../util/package-summary.html">org.apache.drill.exec.resourcemgr.util</a></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</div>
</li>
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab1" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab1', 2)" class="table-tab">Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel">
<div class="summary-table two-column-summary" aria-labelledby="class-summary-tab0">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="QueryQueueConfig.html" title="interface in org.apache.drill.exec.resourcemgr.config">QueryQueueConfig</a></div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Interface which defines an implementation for managing queue configuration of a leaf <a href="ResourcePool.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePool</code></a></div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="QueryQueueConfigImpl.html" title="class in org.apache.drill.exec.resourcemgr.config">QueryQueueConfigImpl</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Parses and initialize QueueConfiguration for a <a href="ResourcePool.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePool</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="QueueAssignmentResult.html" title="class in org.apache.drill.exec.resourcemgr.config">QueueAssignmentResult</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Used to keep track of selected leaf and all rejected <a href="ResourcePool.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePool</code></a> for the provided query.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="ResourcePool.html" title="interface in org.apache.drill.exec.resourcemgr.config">ResourcePool</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Interface which defines an implementation of ResourcePool configuration for <a href="ResourcePoolTree.html" title="interface in org.apache.drill.exec.resourcemgr.config"><code>ResourcePoolTree</code></a></div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ResourcePoolImpl.html" title="class in org.apache.drill.exec.resourcemgr.config">ResourcePoolImpl</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Parses and initializes all the provided configuration for a ResourcePool defined in RM configuration.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab1"><a href="ResourcePoolTree.html" title="interface in org.apache.drill.exec.resourcemgr.config">ResourcePoolTree</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab1">
<div class="block">Interface which defines the implementation of a hierarchical configuration for all the ResourcePool that will be
 used for ResourceManagement</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ResourcePoolTreeImpl.html" title="class in org.apache.drill.exec.resourcemgr.config">ResourcePoolTreeImpl</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Parses and initializes configuration for ResourceManagement in Drill.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="RMCommonDefaults.html" title="class in org.apache.drill.exec.resourcemgr.config">RMCommonDefaults</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Defines all the default values used for the optional configurations for ResourceManagement</div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2023 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
