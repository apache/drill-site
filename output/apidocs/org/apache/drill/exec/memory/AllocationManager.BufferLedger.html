<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>AllocationManager.BufferLedger (Drill : 1.21.2-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.drill.exec.memory, class: AllocationManager, class: BufferLedger">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/AllocationManager.BufferLedger.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.drill.exec.memory</a></div>
<h1 title="Class AllocationManager.BufferLedger" class="title">Class AllocationManager.BufferLedger</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.apache.drill.exec.memory.AllocationManager.BufferLedger</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Enclosing class:</dt>
<dd><a href="AllocationManager.html" title="class in org.apache.drill.exec.memory">AllocationManager</a></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">AllocationManager.BufferLedger</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">The reference manager that binds an allocator manager to a particular
 BaseAllocator. Also responsible for creating a set of DrillBufs that share
 a common fate and set of reference counts. As with AllocationManager, the
 only reason this is public is due to DrillBuf being in io.netty.buffer
 package.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#decrement(int)" class="member-name-link">decrement</a><wbr>(int&nbsp;decrement)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Decrement the ledger's reference count.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getAccountedSize()" class="member-name-link">getAccountedSize</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Amount of memory accounted for by this ledger.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="AllocationManager.BufferLedger.html" title="class in org.apache.drill.exec.memory">AllocationManager.BufferLedger</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getLedgerForAllocator(org.apache.drill.exec.memory.BufferAllocator)" class="member-name-link">getLedgerForAllocator</a><wbr>(<a href="BufferAllocator.html" title="interface in org.apache.drill.exec.memory">BufferAllocator</a>&nbsp;allocator)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the ledger associated with a particular BufferAllocator.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSize()" class="member-name-link">getSize</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">The total size (in bytes) of memory underlying this ledger.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="../../../../../io/netty/buffer/UnsafeDirectLittleEndian.html" title="class in io.netty.buffer">UnsafeDirectLittleEndian</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getUnderlying()" class="member-name-link">getUnderlying</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Package visible for debugging/verification only.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#isOwningLedger()" class="member-name-link">isOwningLedger</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Package visible for debugging/verification only.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../../../io/netty/buffer/DrillBuf.html" title="class in io.netty.buffer">DrillBuf</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#newDrillBuf(int,int)" class="member-name-link">newDrillBuf</a><wbr>(int&nbsp;offset,
 int&nbsp;length)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Create a new DrillBuf associated with this AllocationManager and memory.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../../../../../io/netty/buffer/DrillBuf.html" title="class in io.netty.buffer">DrillBuf</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#newDrillBuf(int,int,org.apache.drill.exec.ops.BufferManager)" class="member-name-link">newDrillBuf</a><wbr>(int&nbsp;offset,
 int&nbsp;length,
 <a href="../ops/BufferManager.html" title="interface in org.apache.drill.exec.ops">BufferManager</a>&nbsp;manager)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Create a new DrillBuf associated with this AllocationManager and memory.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#print(java.lang.StringBuilder,int,org.apache.drill.exec.memory.BaseAllocator.Verbosity)" class="member-name-link">print</a><wbr>(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a>&nbsp;sb,
 int&nbsp;indent,
 <a href="BaseAllocator.Verbosity.html" title="enum in org.apache.drill.exec.memory">BaseAllocator.Verbosity</a>&nbsp;verbosity)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Print the current ledger state to a the provided StringBuilder.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#transferBalance(org.apache.drill.exec.memory.AllocationManager.BufferLedger)" class="member-name-link">transferBalance</a><wbr>(<a href="AllocationManager.BufferLedger.html" title="class in org.apache.drill.exec.memory">AllocationManager.BufferLedger</a>&nbsp;target)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Transfer any balance the current ledger has to the target ledger.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#clone--" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#finalize--" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#getClass--" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#hashCode--" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#toString--" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait-long-int-" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="transferBalance(org.apache.drill.exec.memory.AllocationManager.BufferLedger)">
<h3>transferBalance</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">transferBalance</span><wbr><span class="parameters">(<a href="AllocationManager.BufferLedger.html" title="class in org.apache.drill.exec.memory">AllocationManager.BufferLedger</a>&nbsp;target)</span></div>
<div class="block">Transfer any balance the current ledger has to the target ledger. In the
 case that the current ledger holds no memory, no transfer is made to the
 new ledger.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>target</code> - The ledger to transfer ownership account to.</dd>
<dt>Returns:</dt>
<dd>Whether transfer fit within target ledgers limits.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="print(java.lang.StringBuilder,int,org.apache.drill.exec.memory.BaseAllocator.Verbosity)">
<h3>print</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">print</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/StringBuilder.html" title="class or interface in java.lang" class="external-link">StringBuilder</a>&nbsp;sb,
 int&nbsp;indent,
 <a href="BaseAllocator.Verbosity.html" title="enum in org.apache.drill.exec.memory">BaseAllocator.Verbosity</a>&nbsp;verbosity)</span></div>
<div class="block">Print the current ledger state to a the provided StringBuilder.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>sb</code> - The StringBuilder to populate.</dd>
<dd><code>indent</code> - The level of indentation to position the data.</dd>
<dd><code>verbosity</code> - The level of verbosity to print.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="decrement(int)">
<h3>decrement</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">decrement</span><wbr><span class="parameters">(int&nbsp;decrement)</span></div>
<div class="block">Decrement the ledger's reference count. If the ledger is decremented to
 zero, this ledger should release its ownership back to the
 AllocationManager</div>
</section>
</li>
<li>
<section class="detail" id="getLedgerForAllocator(org.apache.drill.exec.memory.BufferAllocator)">
<h3>getLedgerForAllocator</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="AllocationManager.BufferLedger.html" title="class in org.apache.drill.exec.memory">AllocationManager.BufferLedger</a></span>&nbsp;<span class="element-name">getLedgerForAllocator</span><wbr><span class="parameters">(<a href="BufferAllocator.html" title="interface in org.apache.drill.exec.memory">BufferAllocator</a>&nbsp;allocator)</span></div>
<div class="block">Returns the ledger associated with a particular BufferAllocator. If the
 BufferAllocator doesn't currently have a ledger associated with this
 AllocationManager, a new one is created. This is placed on BufferLedger
 rather than AllocationManager directly because DrillBufs don't have
 access to AllocationManager and they are the ones responsible for
 exposing the ability to associate multiple allocators with a particular
 piece of underlying memory. Note that this will increment the reference
 count of this ledger by one to ensure the ledger isn't destroyed before
 use.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>allocator</code> - </dd>
<dt>Returns:</dt>
<dd>The ledger associated with a particular BufferAllocator.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newDrillBuf(int,int)">
<h3>newDrillBuf</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../../../io/netty/buffer/DrillBuf.html" title="class in io.netty.buffer">DrillBuf</a></span>&nbsp;<span class="element-name">newDrillBuf</span><wbr><span class="parameters">(int&nbsp;offset,
 int&nbsp;length)</span></div>
<div class="block">Create a new DrillBuf associated with this AllocationManager and memory.
 Does not impact reference count. Typically used for slicing.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>offset</code> - The offset in bytes to start this new DrillBuf.</dd>
<dd><code>length</code> - The length in bytes that this DrillBuf will provide access to.</dd>
<dt>Returns:</dt>
<dd>A new DrillBuf that shares references with all DrillBufs
         associated with this BufferLedger</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="newDrillBuf(int,int,org.apache.drill.exec.ops.BufferManager)">
<h3>newDrillBuf</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../../../../../io/netty/buffer/DrillBuf.html" title="class in io.netty.buffer">DrillBuf</a></span>&nbsp;<span class="element-name">newDrillBuf</span><wbr><span class="parameters">(int&nbsp;offset,
 int&nbsp;length,
 <a href="../ops/BufferManager.html" title="interface in org.apache.drill.exec.ops">BufferManager</a>&nbsp;manager)</span></div>
<div class="block">Create a new DrillBuf associated with this AllocationManager and memory.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>offset</code> - The offset in bytes to start this new DrillBuf.</dd>
<dd><code>length</code> - The length in bytes that this DrillBuf will provide access to.</dd>
<dd><code>manager</code> - An optional BufferManager argument that can be used to manage expansion of this DrillBuf.</dd>
<dt>Returns:</dt>
<dd>A new DrillBuf that shares references with all DrillBufs associated with this BufferLedger.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSize()">
<h3>getSize</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getSize</span>()</div>
<div class="block">The total size (in bytes) of memory underlying this ledger.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Size in bytes</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getAccountedSize()">
<h3>getAccountedSize</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getAccountedSize</span>()</div>
<div class="block">Amount of memory accounted for by this ledger. This is either getSize() if this is the owning ledger for the
 memory or zero in the case that this is not the owning ledger associated with this memory.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Amount of accounted(owned) memory associated with this ledger.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getUnderlying()">
<h3>getUnderlying</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="../../../../../io/netty/buffer/UnsafeDirectLittleEndian.html" title="class in io.netty.buffer">UnsafeDirectLittleEndian</a></span>&nbsp;<span class="element-name">getUnderlying</span>()</div>
<div class="block">Package visible for debugging/verification only.</div>
</section>
</li>
<li>
<section class="detail" id="isOwningLedger()">
<h3>isOwningLedger</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">isOwningLedger</span>()</div>
<div class="block">Package visible for debugging/verification only.</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2023 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
